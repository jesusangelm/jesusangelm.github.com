---
layout: post
title: !binary |-
  VnVlbGEgZW4gSW50ZXJuZXQgdXNhbmRvIHVuYSBDYWNoZSBETlMgLSBEbnNt
  YXNxIGVuIFVidW50dQ==
tags:
- !binary |-
  aW50ZXJuZXQ=
- !binary |-
  bGludXg=
- !binary |-
  c2Vydmlkb3I=
- !binary |-
  dWJ1bnR1
- !binary |-
  c2lzdGVtYQ==
- !binary |-
  aW5zdGFsYXI=
- !binary |-
  YmFy
- !binary |-
  YmFzaA==
- !binary |-
  Y2FjaGU=
- !binary |-
  ZG5z
- !binary |-
  ZG5zbWFzcQ==
- !binary |-
  dGVybWluYWw=
---
Desde hace unos meses para aca mi internet HSDPA ha estado presentando molestos inconveniente los cuales me obligan a recargar/solicitar las paginas mas de una vez para que estas puedan presentarse completamente y sin errores por lo que decidi usar una cache DNS con Dnsmasq para probar como puede esto ayudar a mi conexion y que las paginas cargen a la primera solicitud y sin problemas.

<a href="http://www.thekelleys.org.uk/dnsmasq/doc.html" target="_blank">Dnsmasq</a>, esta es un servidor DHCP y  DNS ligero y de bajo impacto para el sistema que nos permite usarlo cachear las peticiones DNS  hacia internet que realiza nuestro computador pra resolver la IP de un dominio, de manera que cuando se desee accesar de nuevo a un dominio ya resuelto, no se tenga que volver a solicitar a los servidores DNS en internet sino que se resuelven en la misma PC ya que esta conoce de antemano la ip correspondiente.

Antes de instalar Dnsmasq vemos los tiempos aproximados que se tarda mi conexion en resolver la ip de un dominio:

<a href="http://blog.jam.net.ve/imagenes/uploads/2010/08/Pantallazo-23.png"><img class="aligncenter size-medium wp-image-377" title="Pantallazo-23" src="http://blog.jam.net.ve/imagenes/uploads/2010/08/Pantallazo-23-300x134.png" alt="" width="300" height="134" /></a>

Para instalar Dnsmasq tan solo debemos ejecutar en la terminal la siguiente orden: Antes asegurese de tener activado los repositorios "universe"

[bash] sudo apt-get install dnsmasq [/bash]

Luego de esto pasamos a configurar dnsmasq editando el archivo dnsmasq.conf tecleando en la terminal:

[bash] sudo gedit /etc/dnsmasq.conf [/bash]

descomentamos y modificamos la liena que contiene:

[bash] #listen-address= [/bash]

para que quede de esta manera:

[bash] listen-address=127.0.0.1 [/bash]

Luego de esto nos toca editar el cliente DHCP tecleando en la terminal:

[bash] sudo gedit /etc/dhcp3/dhclient.conf [/bash]

y nos aseguramos que las siguientes lineas:

[bash] prepend domain-name-servers 127.0.0.1;
request subnet-mask, broadcast-address, time-offset, routers,
 domain-name, domain-name-servers, domain-search, host-name,
 netbios-name-servers, netbios-scope, interface-mtu,
 rfc3442-classless-static-routes, ntp-servers; [/bash]

esten descomentada y tenga la IP  127.0.0.1

Por ultimo nos toca editar el archivo resolv.conf  y agregar la ip de nuestro servidor cache dns local tecleando en la terminal:

[bash] sudo gedit /etc/resolv.conf [/bash]

y colocamos nuestra IP local de primero en la lista de modo que quede similar a esto:

[bash] # Generated by NetworkManager
nameserver 127.0.0.1
nameserver 208.67.222.222
nameserver 208.67.220.220 [/bash]

por ultimo reiniciamos dnsmasq para que aplique la configuracion:

[bash] sudo /etc/init.d/dnsmasq restart [/bash]

Por ultimo consultamos 2 veces  (¿porque dos veces?: la primera para que haga la consulta a internet y permitir que dnsmasq la almacene en cache y la segunda para que se realicw la consulta de manera local ya que dnsmasq conoce ya la ip resultante y no se necesita hacer consultas al exterior) el mismo dominio para ver el tiempo que se toma ahora...

<a href="http://blog.jam.net.ve/imagenes/uploads/2010/08/Pantallazo-24.png"><img class="aligncenter size-medium wp-image-378" title="Pantallazo-24" src="http://blog.jam.net.ve/imagenes/uploads/2010/08/Pantallazo-24-300x128.png" alt="" width="300" height="128" /></a>

como ven ahora es mucho mas rapido si se realizan consultas locales a dominios ya resueltos con anterioridad.

Saludos y espero le sirva.
